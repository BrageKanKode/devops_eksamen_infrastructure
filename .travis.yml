env:
  global:
  - GCP_PROJECT_ID=examinfrastructure-295710
  - tf_version=0.13.5
  - CLOUDSDK_CORE_DISABLE_PROMPTS=1
  - secure: 5mmFIQFtydJPBHGoevE5N0afjbGrr228K5D7RlDuF7A5ChbF2Smm9xEo2R5HP0QtE/4AdaRptUrpy6mVa0ei5RGS5dbasp0uYDsoOso6QeAtIpHenrxAhihWpEsQs4QwZ5Dmbn69Sas4yobBgv35xZOtt5bNldhcyLrnAMMqOfjtDDb2ERIbTrxAbsp1O+am8v5nPANxyQKYMBRDR/x3VPclDcNUX1/F6vWs8S9x1VCRqEjCVMl5DsheJA3L4ru3HvWVgAUJnP3cQ3gOQ5YDWkCSEYLVOLzXkwlJthn1O9ftltEZycNKdwSrLsQfXCxhmCmU6l7JMf2z3uV/MsZJqdCYZBqJiJc5Scus4S76BBzkeJodpf/JAbkuR0pyACkLrut/uWwSLDkJpLsxASOgg/u5VnQP93Hrn1YGhzl2/5JviurEQG3hkyZvkR38hMGCsjKyro06wRse0H+ySW7A6SyRkPO21LvmPCKeK4IpHi4W5G0pKcpYduo5DOBRjzLP+swsTiMHEquIZkuRbiaKrID236bbLIeXb8PHMuNlAnTizHEGuKblpXhpZgVkWdp7I3g+tLP/BGXw6cdpYyHAX/wv4TgeuSWzZozir+4wTlarlFikIg5djW6ea6M6nwZmWf+Mx87iKFN8Uy+MiGA3da255qshMzvHfdnjwS7rBrQ=
  - secure: RVXdBRmHTmzy/NUn+D5m37KH3263zEgoBJQh4j3O8s3e7ibptYzDBxvwWKaLS3KewaU0z5rOGizQITC2xfs0z/azfFLuelgmcJyo/FoPdx+gOktTgknFiYbc2634V/lCwsjQ1qFaD7HE4kmiwaFS3Zlbse7NIdkVtQkmgnu/ETfhauQK57giQ4dt70hCrNqRPGYp10HGWe3EWp7hHywyBQhdl4zZwMqSytoxjEhOgzZfkXT5HAjDmm7fHcKhgWvYXqJfdCDkkKm9PcxN9JBW1yVgxOc7TADWLf9VEVmsFApnDrAxFfvQ91EwWQ2xlzTzcoyTo6CxxrjLoxYJH5v6tIm8Vbfw2iav+Gi0sQ7JQrb3uUigJhoFTCzpYET37ykRdabSseoiDlcahvs8FAafHag/TdrsrMe/dDjLuh0Mf7OmjZzERdgkh3cOUFozinrdAv2Kkb9b8J0ikmdgQZCEIthA0MAVAWB4xQz4961HiSIvA2Z+d3qUJZNe/6Mn9ZyuekoCEFGGEs5eX/7kcHZBMZ+aUEwDjrpZMBrfcvcduJ+fM0MnXn5D33jdUD3rfu6xo0RrBOKKWhCKTGLmXlW2cl87JPsJLvUQjuRSZL7LK3EjuEpHRBC/G0k/VNE3jRHlHM7AAlDxUfcpOJ183kReO/MSs00rCtS49OG8snkM7SQ=
branches:
  only:
  - master
before_install:
- openssl aes-256-cbc -K $encrypted_3bf60d793673_key -iv $encrypted_3bf60d793673_iv
  -in terraform.json.enc -out terraform.json -d
- curl https://sdk.cloud.google.com | bash > /dev/null
- source "$HOME/google-cloud-sdk/path.bash.inc"
- gcloud auth activate-service-account --key-file=terraform.json
- gcloud config set project "${GCP_PROJECT_ID}"
- export GOOGLE_APPLICATION_CREDENTIALS=./terraform.json
- wget https://releases.hashicorp.com/terraform/"$tf_version"/terraform_"$tf_version"_linux_amd64.zip
- unzip terraform_"$tf_version"_linux_amd64.zip
- sudo mv terraform /usr/local/bin/
- rm terraform_"$tf_version"_linux_amd64.zip
install: true
script:
- |-
  set -ex;
  export TF_VAR_LOGZ_TOKEN=$LOGZ_TOKEN
  export TF_VAR_LOGZ_URL=$LOGZ_URL
  terraform init
  terraform plan
  terraform apply --auto-approve
  terraform output
